# MANAGED BY fredrikaverpil/github - DO NOT EDIT
# This file is automatically updated during sync operations
# Source: https://github.com/fredrikaverpil/github

version: '3'

vars:
  ROOT_DIR:
    sh: git rev-parse --show-toplevel
  # renovate: datasource=crate depName=stylua
  STYLUA_VERSION: 2.0.0

tasks:
  default:
    desc: List all available tasks
    cmds:
      - task -t Taskfile.lua.yml --list

  format:
    desc: Format Lua files with stylua
    cmds:
      - task: ensure-stylua
      - stylua --config-path {{.ROOT_DIR}}/stylua.toml .
      - git diff --color=always --exit-code

  install-stylua:
    desc: Install stylua
    aliases: ["install"]
    cmds:
      - cargo install stylua --version {{.STYLUA_VERSION}} --force

  ensure-stylua:
    internal: true
    status:
      - which stylua >/dev/null 2>&1 && stylua --version | grep -q {{.STYLUA_VERSION}}
    cmds:
      - task: install-stylua

  no-op:
    aliases: ["test", "lint"]
    cmds:
      - echo 0
